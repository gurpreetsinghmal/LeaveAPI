<!DOCTYPE html>
<html>
<head>
    <title>CORS-Free Google Sheet Table</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css" />

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.4/tabletop.min.js"></script>
</head>

<body>
<h2>Google Sheet â†’ DataTable (CORS-Free)</h2>

<table id="sheetTable" class="display" width="100%"></table>

<script>
window.onload = function() {

    Tabletop.init({
        key: "1X2TVrDAh43bxUR8y0XjwwCaEPcxfDoG-Rh_eiFJypRk",
        simpleSheet: true,
        callback: function (data) {

            var columns = Object.keys(data[0]).map(k => ({ title: k }));
            var rows = data.map(obj => Object.values(obj));

            $("#sheetTable").DataTable({
                data: rows,
                columns: columns
            });
        }
    });

}
</script>

</body>
</html>
