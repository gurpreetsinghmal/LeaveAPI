<!DOCTYPE html>
<html>

<head>
    <title>Google Sheet DataTable</title>

    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.5/css/jquery.dataTables.min.css">
    <script src="https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js"></script>

    <style>
        body {
            font-family: Arial;
            padding: 20px;
        }
    </style>
</head>

<body>

    <h2>Google Sheet â†’ DataTable</h2>

    <table id="sheetTable" class="display" width="100%"></table>

    <script>
        $(document).ready(function () {

            // Your Google Sheet ID
            var sheetID = "1X2TVrDAh43bxUR8y0XjwwCaEPcxfDoG-Rh_eiFJypRk";

            // gviz API URL (NO CORS)
            var url =
                "https://docs.google.com/spreadsheets/d/" +
                sheetID +
                "/gviz/tq?tqx=out:json&tq&gid=0";

            fetch(url)
                .then(res => res.text())
                .then(text => {
                    // Clean Google GViz JSON
                    var json = JSON.parse(text.substr(47).slice(0, -2));

                    // Extract header + rows
                    var columns = json.table.cols.map(col => ({
                        title: col.label
                    }));

                    var rows = json.table.rows.map(row =>
                        row.c.map(cell => (cell ? cell.v : ""))
                    );

                    // Initialize DataTable
                    $("#sheetTable").DataTable({
                        data: rows,
                        columns: columns
                    });
                })
                .catch(err => console.error("Error loading sheet:", err));

        });
    </script>

</body>

</html>